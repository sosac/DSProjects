-- connie sosa : 4/19/2016 : ds730 : project 6
-- project6ii.hive

-----------------------------------------------------------------
-- problem 2: top 3 birthdates

INSERT OVERWRITE DIRECTORY '/home/hduser/hive/pj6prob2' 
SELECT bmonth, '/', bday, ':', count(id) AS num_people 
FROM master
WHERE bday is NOT NULL AND bmonth is NOT NULL
GROUP BY bmonth, bday
SORT BY num_people DESC LIMIT 3;


